<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Deploy Memos on AWS for fun</title>
    <url>/2023/05/01/deploy-memos-on-AWS-for-fun/</url>
    <content><![CDATA[<p>Memos <a href="https://github.com/usememos/memos">Github Link</a> is a lightweight, self-hosted memo hub. Open Source. Currently there are docs supporting manage hosting <a href="https://usememos.com/docs/install/managed">link</a> on Render.com, Fly.io, PikaPods.com.</p>
<p>I tried to deploy Memos app on AWS with ECR, ECS Fargate and Application Load balancer(ALB). JUST FOR FUN. Because it is too <strong>EXPENSIVE</strong>. Memo is a long-lived app and almost certainly needs a load balancer. ALB by itself will cost $16.2&#x2F;month.<br>My setup has no HTTPS, no CDK. It is against a lot of best practices :).</p>
<p>I will recommend using Fly.io</p>
<ul>
<li>You can manage the whole thing at $0! </li>
<li>Automatic db backup to S3 bucket with easy setup</li>
<li>Easy to upgrade</li>
</ul>
<p>I quickly moved to Fly.io after I finished this blog :)</p>
<p>Assume you already have a AWS account.</p>
<h3 id="Local-code-change"><a href="#Local-code-change" class="headerlink" title="Local code change"></a>Local code change</h3><ul>
<li>Pull the git repo to local environment <a href="https://github.com/usememos/memos">https://github.com/usememos/memos</a></li>
<li>If you want to automatically backup db file to a S3 bucket<ul>
<li>Go to AWS Console S3 page, create a bucket. Give it a name, for example, mymemos</li>
<li>Modify your local repo following this <a href="https://github.com/usememos/memos/compare/main...XiyanHu:memos:blog">commit example</a>, replace litestream.yml file with your information<ul>
<li>This is basically copy paste from <a href="https://github.com/hu3rror/memos-on-fly">https://github.com/hu3rror/memos-on-fly</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Deploy-to-ECR"><a href="#Deploy-to-ECR" class="headerlink" title="Deploy to ECR"></a>Deploy to ECR</h3><ul>
<li>Search ECR in AWS console. Click Create repository, give it a name, for example, mymemos</li>
<li>You will see your docker on the dashboard. Click on your docker repository</li>
<li>Click View Push Commands, and follow the instruction there to deploy your app<img src="/2023/05/01/deploy-memos-on-AWS-for-fun/push_command_screenshot.png" class="" title="This is an example image"></li>
</ul>
<h3 id="Create-ALB"><a href="#Create-ALB" class="headerlink" title="Create ALB"></a>Create ALB</h3><ul>
<li>Search load balancers in AWS console. Find EC2 and on left panel click Load Balancers</li>
<li>Click Create load balancer, choose Application Load Balancer<ul>
<li>Give it a name, choose VPC and Security groups</li>
<li>Under Listeners and routing tab, click Create target group <ul>
<li>Choose IP addresses as target type</li>
<li>Protocol HTTP and Port 5230</li>
</ul>
</li>
<li>Select the target group just created</li>
<li>Click Create Load Balancer</li>
</ul>
</li>
</ul>
<h3 id="Config-Security-group"><a href="#Config-Security-group" class="headerlink" title="Config Security group"></a>Config Security group</h3><ul>
<li>I only have a default security group, select it. Under Inbound rules tab, click Edit Inbound rules</li>
<li>Add Type Custom TCP, Port Range 5230, Source 0.0.0.0&#x2F;0</li>
<li>Add Type HTTP, Port Range 80, Source 0.0.0.0&#x2F;0</li>
<li>Save it and go to outbound rules, Add Type Custom TCP, Port Range 5230, Source 0.0.0.0&#x2F;0</li>
</ul>
<h3 id="Config-ECS"><a href="#Config-ECS" class="headerlink" title="Config ECS"></a>Config ECS</h3><ul>
<li>Search ECS in AWS console, on left panel, click Task definitions</li>
<li>Click Create new task definition</li>
<li>Set Image Url to XXXXXX.dkr.ecr.us-east-1.amazonaws.com&#x2F;mymemos, you can get it from ECR page</li>
<li>Set port tp 5230 with is the default in memos app</li>
<li>Click Create if you don’t want to do other fancy settings<img src="/2023/05/01/deploy-memos-on-AWS-for-fun/task_definition.png" class="" title="This is an example image"></li>
<li>Click Cluster on left panel, then Create cluster<ul>
<li>Set Cluster name, add VPC and subnet</li>
<li>Click Create</li>
</ul>
</li>
<li>Select the cluster you created<ul>
<li>If you want to save money, consider <a href="https://aws.amazon.com/blogs/aws/aws-fargate-spot-now-generally-available/">Fargate Spot</a>. 70% discount!!!</li>
<li>Under Services Tab, click Create<ul>
<li>Under Deployment configuration, choose the family created in the previous step<img src="/2023/05/01/deploy-memos-on-AWS-for-fun/service_deployment_config.png" class="" title="This is an example image"></li>
</ul>
</li>
<li>Under Load Balancer, choose the ALB and target group created in the previous step <img src="/2023/05/01/deploy-memos-on-AWS-for-fun/service_config_lb.png" class="" title="This is an example image"></li>
<li>After service is created you should see a task running. </li>
<li>Go to your broswer with your ALB DNS name you should see the memo homepage let you to create an user<img src="/2023/05/01/deploy-memos-on-AWS-for-fun/alb.png" class="" title="This is an example image">
<img src="/2023/05/01/deploy-memos-on-AWS-for-fun/signin.png" class="" title="This is an example image"></li>
<li>In the s3 bucket you should see a folder name with memos_prod.db&#x2F;.</li>
</ul>
</li>
</ul>
<h3 id="What’s-Next"><a href="#What’s-Next" class="headerlink" title="What’s Next"></a>What’s Next</h3><ul>
<li>Consider replace ALB with API Gateway + CloudMap to cut cost : <a href="https://awsteele.com/blog/2022/10/15/cheap-serverless-containers-using-api-gateway.html">https://awsteele.com/blog/2022/10/15/cheap-serverless-containers-using-api-gateway.html</a></li>
<li>Move to Fly.io :)</li>
</ul>
]]></content>
      <tags>
        <tag>test</tag>
      </tags>
  </entry>
  <entry>
    <title>我怎么就成了Senior</title>
    <url>/2023/07/03/how-I-become-a-senior-in-Amazon/</url>
    <content><![CDATA[<p>想起2022年中的时候，各个公司手里甩着钞票招人，10个人里有10个人想着跳槽。那时组里升职论资排辈我估计顺位比约基奇还低，日常工作能轻松应付，感觉到自己陷入了舒适区 - 唯一不舒适的是钱不够多。我寻思着，这不行啊，一拍桌子，大胆立下“三年计划” ： 刷题！跳到另一家公司拿大包裹然后干三年再回来亚麻空降L6 - 额，拿更大的包裹。当我兴致勃勃地开始执行计划时，计划赶不上变化，整体形势下行，我就被困住了。一年后，我升了Senior。那这是咋回事呢，我们不妨来回顾一下。首先叠个甲，纯粹个人观点和随想，没有普适性。</p>
<h2 id="运气"><a href="#运气" class="headerlink" title="+++ 运气"></a>+++ 运气</h2><p>客观条件是我们这个小org太特么需要一个senior了，没有senior很多事情周转不过来。去年的一波跳槽风波，我由于手脚太慢，导致拔剑四顾的时候，公司都开始裁员了。手脚快的组里兄弟们跳了个一干二净。那时候每周一个散伙饭。我突然变成了后端组工龄最长的人，那自然而然就轮到我了。我更像是被推出来的一个代表 - “名誉senior” - 有了我很多地方就可以便宜行事。AKA风口上的猪。</p>
<div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 50%;"><img src="/2023/07/03/how-I-become-a-senior-in-Amazon/sanhuofan.jpeg" class=""></div><div class="group-picture-column" style="width: 50%;"><img src="/2023/07/03/how-I-become-a-senior-in-Amazon/flyingPig.jpeg" class=""></div></div></div></div>

<h2 id="心态建设"><a href="#心态建设" class="headerlink" title="+ 心态建设"></a>+ 心态建设</h2><p>我之前有个帅哥老板，长得有点儿像祖国人，能力很强。从他身上我了解到了</p>
<ul>
<li>正儿八经项目的管理该是怎样的 - 这点略过不谈，我不是很会</li>
<li>面对不同意见正确的心态该是咋样的<ul>
<li>不气盛还叫年轻人吗？所以我初入职场很多遭遇到质疑的时候，不是先思考到底对方说的对不对，而是直接维护自己 - “你说的可能是对的，但是我一定没错！”。这个心态回过头来看是不好的，只要对面不是故意在针对我，那么ta提出的意见，一定是对解决问题有帮助的。Embrace a growth mindset.</li>
</ul>
</li>
<li>如何处理自己力所不能及的事情 - 简单来说就是摇人。</li>
</ul>
<h2 id="学会问一个好问题-amp-知其所以然"><a href="#学会问一个好问题-amp-知其所以然" class="headerlink" title="+ 学会问一个好问题 &amp; 知其所以然"></a>+ 学会问一个好问题 &amp; 知其所以然</h2><p>这两点一起讲是因为受到同一个人启发。2018年我刚加入组里的时候组里一共就4个人，其中一个senior，他看起来很凶，相处久了才发现他是一个很亚撒西的人（这是后话）。他写码如喝汤，我对他是满满的敬畏。<img src="/2023/07/03/how-I-become-a-senior-in-Amazon/jinwei.jpeg" class=""> 我刚进去问题很多，但不能只逮着一个人问，怕他们烦我，所以最后很大一部分问题我都不得不硬着头皮去问senior。每次我都贼紧张，因为他特别喜欢反问我。这就倒逼我</p>
<ul>
<li>学会问一个好问题。说实话工作中有两种问题很难回答：<ul>
<li>贼宽泛的问题。这是工作，不是哲学。你这让我怎么回答嘛，打小作文？一般这时候我就一句反问甩过去：你到底从我这里想得到什么。所以，我的理解是问以前尽可能地拆解问题。</li>
<li>伸手党或者是那种单细胞生物才能问出来的问题（说实话后者第一次我完全可以理解，但是一而再再而三就不好了嘛）。我希望看到的是问问题的人做过了研究，试过了XYZ的方式，但是还是存在问题，甚至列出了觉得可能出问题的地方在哪里，等等。</li>
</ul>
</li>
<li>试着去理解问题的原理。Senior不单单是帮我解决问题，还给我画一堆图解释原理。说实话当年年轻的我不一定全听懂了，但是刻下了一个思想钢印：如果你想要触类旁通举一反三，还是得知道原理。莫非这就是破产版的第一性原理？</li>
</ul>
<h2 id="贵人们"><a href="#贵人们" class="headerlink" title="+ 贵人们"></a>+ 贵人们</h2><p>有太多的人我需要感谢了，很多与你们相处的点点滴滴我都记在心里。这里我必须插一张SCARE双雄（熊）的图。<img src="/2023/07/03/how-I-become-a-senior-in-Amazon/bears.jpeg" class=""> 篇幅有限我就不一一盘点了，如果想和我“忆往昔峥嵘岁月稠”，欢迎来私聊我：）</p>
<h2 id="解决问题的能力"><a href="#解决问题的能力" class="headerlink" title="+ 解决问题的能力"></a>+ 解决问题的能力</h2><p>我认为顶头老板们关心的啥：我给你一个问题，你能不能把这个事办好了，办得漂亮。沟通技巧，技术水平，组织能力通通是为了解决问题而服务。我觉得我有“在当前资源配置下解决复杂问题的能力”。是不是任何东西加了一堆限定词就感觉没这么厉害了？比如93%赛季冠军（对不起阿森纳球迷）。当遇到一个棘手的问题，老板信任我，我了解的技术也能支撑我解决问题的难点，我有认识的大佬可以咨询，我能管好一起干活组员的进度（毕竟呆了4年，确实是有一些面子果实的，工作比较容易开展），最后解决问题。慢慢地老板自然觉得把最艰巨的活交给你放心，机会这不就来了？</p>
<h2 id="建立和同事之间的信任"><a href="#建立和同事之间的信任" class="headerlink" title="+ 建立和同事之间的信任"></a>+ 建立和同事之间的信任</h2><ul>
<li>首先为什么？<ul>
<li>同事的反馈会在升职中起到相当大的作用。</li>
<li>你带一个项目，如果手下都是你的仇人那这边建议直接自爆，人心散了队伍不好带的。</li>
</ul>
</li>
<li>其次怎么办？我觉得没啥特别的技巧，无外乎四个字，真诚，时间。<ul>
<li>时间好说，感情嘛，慢慢培养。前端组是我们组的上游，每一个同事，我都能很快回忆起我们共事的经历，合作项目，解决SEV2，一起赶ddl等等，虽然可能过程很波折，但是最终都能圆满完成任务。这样一来升职的时候大家自然有好的故事讲。</li>
<li>真诚我理解是“以直报怨，以德报德”。在力所能及的范围内尽力帮助有需要的同事，口碑这个东西会发酵的。当然也不是说来者不拒，学会拒绝也很重要 - 或者微笑地和ta说：XXX有更多的上下文，要不你先问问？对于帮助我的同事我会心怀感激，不吝啬赞美。对于已经发生的事情不抱怨（做人也是这样？）。比如一次我在新墨西哥玩的时候打牌真酣的时候被page，陪同事打了1个多钟头电话，虽然心里万马奔腾但是还是要保持微笑。</li>
</ul>
</li>
</ul>
<h2 id="管理自己的职业生涯"><a href="#管理自己的职业生涯" class="headerlink" title="+ 管理自己的职业生涯"></a>+ 管理自己的职业生涯</h2><p>You own your career，这也是我每一任老板给我灌输的概念。我很少见到“舔狗式”老板，就是说追着要给你升职那种（可能我还不够强）。所以呢，主动一些，表现出自己的野心，给老板上上强度。我很多升职材料都是尽量自己多提供一些素材，帮老板减减负，双赢，毕竟自己也最了解自己做了什么。</p>
<h2 id="技术"><a href="#技术" class="headerlink" title="- 技术"></a>- 技术</h2><p>我不觉得我自己技术很强。我面对的是大量的业务逻辑，技术选型也不能说很复杂，高并发什么的一定抓瞎。论技术我一定比不过AWS的。学，学无止境好吧</p>
<h2 id="商业写作"><a href="#商业写作" class="headerlink" title="- 商业写作"></a>- 商业写作</h2><p>就是写one pager, six pagers之类的，语法，技巧等等。这方面我到现在仍然是依托答辩，我在努力学习答辩上雕花。</p>
<h2 id="社交"><a href="#社交" class="headerlink" title="- 社交"></a>- 社交</h2><p>我是尽可能避开happy hour和team event(团建)，闲聊太特么尬了。我真要说话，那也只在聊到我感兴趣的地方插两句。所以社交在我看来没啥影响。当然啊，这不是说我和组里人关系差，熟悉我的朋友应该还是认同我是有一点幽默细胞的。我的老板大老板们，都贼能讲故事，我只要做一个耐心的听众，适当锐评两句。</p>
<h2 id="？-动力"><a href="#？-动力" class="headerlink" title="？ 动力"></a>？ 动力</h2><p>我对工作的热情会有峰和谷，也经常会迷茫，彷徨，有特别划的时候。而且也会和我个人生活的状态挂钩。不得不承认动力确实很难保持。Always day1?毕竟我身上肩负着要成为VP的别人的期望：）。</p>
]]></content>
  </entry>
</search>
